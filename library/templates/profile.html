{% extends 'layout.html' %}

{% block head_content %}

{% endblock %}

{% block main_content %}

{% if profile_data %}

<h3> Welcome, {{ profile_data.email }}!</h3>
<h4> User profile</h4>
<p> Name: {{ profile_data.name }} </p>
<p> Surname: {{ profile_data.surname }} </p>
<p> Birthdate: {{ profile_data.get_birthdate() }} </p>
<p> Email: {{ profile_data.email }} </p>
<p> Telephone: {{ profile_data.telephone }} </p>
<a href="{{ url_for('pages.edit_profile', _id=profile_data._id) }}">Edit Profile</a>
<br>
<a href="{{ url_for('authorize.change_password' )}}">Change Password</a>

{% else %}
<h3> User not found </h3>
<p> The User with specified ID does not exist. </p>
{% endif %}

{% if current_user.isDoctor %}

<h4>Appointments</h4>
{% if appointment %}
<table class="table">
    <thead>
        <tr>
            <th>Date</th>
            <th>Time</th>
            <th>Patient Name</th>
            <th>Patient Surname</th>
            <th>Availability</th>
            <th>Delete</th>
        </tr>
    </thead>
    <tbody>
        {% for app in appointment %}
        <tr>
            <td>{{ app.app_date }}</td>
            <td>{{ app.app_time }}</td>
            {% if app.patient_id %}
            <td>{{ app.profile.name }}</td>
            <td>{{ app.profile.surname }}</td>
            {% else %}
            <td>N/A</td>
            <td>N/A</td>
            {% endif %}
            <td>{{ "Available" if app.availability else "Booked" }}</td>
            <td> <a href="{{ url_for('pages.delete_app', app_id=app.app_id) }}" class="btn btn-danger"><i
                        class="fas fa-trash-alt"></i></a> </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<p>You have no appointments yet.</p>
{% endif %}

{% elif current_user.isPatient %}

<h4>Booked Appointments</h4>
{% if booked_app %}
<table class="table">
    <thead>
        <tr>
            <th>Date</th>
            <th>Time</th>
            <th>Doctor Name</th>
            <th>Doctor Surname</th>
            <th>Delete</th>
        </tr>
    </thead>
    <tbody>
        {% for app in booked_app %}
        <tr>
            <td>{{ app.app_date }}</td>
            <td>{{ app.app_time }}</td>
            {% if app.doctor_id %}
            <td>{{ app.doctorstable.profile.name }}</td>
            <td>{{ app.doctorstable.profile.surname }}</td>
            {% else %}
            <td>Doctor information not available</td>
            <td>Doctor information not available</td>
            {% endif %}
            <td> <a href="{{ url_for('pages.delete_app', app_id=app.app_id) }}" class="btn btn-danger"><i
                        class="fas fa-trash-alt"></i></a> </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<p>You have not booked any appointments yet.</p>
{% endif %}

{% else %}
<h3> User not found </h3>
<p> The User with specified ID does not exist. </p>
{% endif %}

{% endblock %}